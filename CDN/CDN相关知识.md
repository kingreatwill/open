
## Apache Traffic Server(ATS)
ATS最重要的是CDN缓存能力,反向代理是其第二功能.

[ATS CDN 搭建](https://www.taterli.com/8527/)

## CDN基础知识
[CDN基础知识-CNAME、加速域名、源站地址与回源host之间的关系](https://blog.csdn.net/qq_43442524/article/details/110479939)

## 回源SNI
如果您的源站IP绑定了多个域名，且CDN回源协议为HTTPS时，需配置回源SNI，在回源SNI内指明所请求的具体域名，服务器会根据该域名正确地返回对应的SSL证书。
根据 SNI（Server Name Indication）信息来获取域名证书和私钥信息。

[配置回源SNI](https://help.aliyun.com/document_detail/111152.html?spm=a2c4g.125959.0.0.258a2240mTnVex)

## 其它
### 第一公里
是指万维网流量向用户传送的第一个出口,即网站服务器接入互联网所能提供的带宽

## 最后一公里
是指万维网流量向用户传送的最后一段接入链路,即用户接入带宽

## 大区划分
CDN常见划分方式:

1. 按照中国电信/联通/移动等运营商的传统大区划分

| 大区 | 包含省份 |
|----------|------------------------------------------------------------------------|
| 华北 | 北京、天津、河北、山西、内蒙古 |
| 东北 | 辽宁、吉林、黑龙江 |
| 华东 | 上海、江苏、浙江、安徽、福建、江西、山东 |
| 华南 | 广东、广西、海南 |
| 华中 | 河南、湖北、湖南 |
| 西南 | 重庆、四川、贵州、云南、西藏 |
| 西北 | 陕西、甘肃、青海、宁夏、新疆 |

2. 按照国家统计局/行政区划标准

| 大区 | 包含省份 |
|----------|------------------------------------------------------------------------|
| 华北 | 北京、天津、河北、山西、内蒙古 |
| 东北 | 辽宁、吉林、黑龙江 |
| 华东 | 上海、江苏、浙江、安徽、福建、江西、山东 |
| 华中 | 河南、湖北、湖南 |
| 华南 | 广东、广西、海南 |
| 西南 | 重庆、四川、贵州、云南、西藏 |
| 西北 | 陕西、甘肃、青海、宁夏、新疆 |

> 这种划分与运营商划分基本一致，部分CDN厂商会将“港澳台”单独列为一个大区。

3. 示例表格

| 大区 | 省份列表 |
|----------|--------------------------------------------|
| 华北 | 北京、天津、河北、山西、内蒙古 |
| 东北 | 辽宁、吉林、黑龙江 |
| 华东 | 上海、江苏、浙江、安徽、福建、江西、山东 |
| 华南 | 广东、广西、海南 |
| 华中 | 河南、湖北、湖南 |
| 西南 | 重庆、四川、贵州、云南、西藏 |
| 西北 | 陕西、甘肃、青海、宁夏、新疆 |
| 港澳台 | 香港、澳门、台湾 |

4. 阿里云CDN大区划分

| 大区 | 省份/地区 |
|----------|--------------------------------------------|
| 华北 | 北京、天津、河北、山西、内蒙古 |
| 东北 | 辽宁、吉林、黑龙江 |
| 华东 | 上海、江苏、浙江、安徽、福建、江西、山东 |
| 华南 | 广东、广西、海南 |
| 华中 | 河南、湖北、湖南 |
| 西南 | 重庆、四川、贵州、云南、西藏 |
| 西北 | 陕西、甘肃、青海、宁夏、新疆 |
| 港澳台 | 香港、澳门、台湾 |

参考：阿里云CDN地域和运营商说明

5. 腾讯云CDN大区划分

| 大区 | 省份/地区 |
|----------|--------------------------------------------|
| 华北 | 北京、天津、河北、山西、内蒙古 |
| 东北 | 辽宁、吉林、黑龙江 |
| 华东 | 上海、江苏、浙江、安徽、福建、江西、山东 |
| 华南 | 广东、广西、海南 |
| 华中 | 河南、湖北、湖南 |
| 西南 | 重庆、四川、贵州、云南、西藏 |
| 西北 | 陕西、甘肃、青海、宁夏、新疆 |
| 港澳台 | 香港、澳门、台湾 |

参考：腾讯云CDN地域和运营商说明

6. 百度云CDN大区划分

| 大区 | 省份/地区 |
|----------|--------------------------------------------|
| 华北 | 北京、天津、河北、山西、内蒙古 |
| 东北 | 辽宁、吉林、黑龙江 |
| 华东 | 上海、江苏、浙江、安徽、福建、江西、山东 |
| 华南 | 广东、广西、海南 |
| 华中 | 河南、湖北、湖南 |
| 西南 | 重庆、四川、贵州、云南、西藏 |
| 西北 | 陕西、甘肃、青海、宁夏、新疆 |
| 港澳台 | 香港、澳门、台湾 |

7. 其他常见划分方式
港澳台单独划分：香港、澳门、台湾单独为“港澳台大区”。
直辖市单独划分：北京、上海、天津、重庆单独为“直辖市大区”。
自定义大区：根据业务需求灵活划分，如“东部沿海”、“西部内陆”等。

## bps和pps
1.bps和pps的区别

bps和pps作为衡量网络吞吐量的单位，从功能上而言两者没有区别。

但是，两者的使用环境截然不同。
bps bit per second的缩写。也可以表示成b/s。这是此类单位的最小单位。
就现在的网络环境而言，常用的单位有Kb/s，Mb/s以及更易于计算的KB/s，MB/s等。
其中小写b和大写B分别对应大小单位bit（比特）和byte（字节）。
两者关系为8 bits = 1 byte.
而K，M等表示kilo，mega等，用于放大单位便于识别和计算。
转系为1024 Bytes =1 KB，1024 KB=1 MB，（2的10次方）
在计算机中，数据以二进制位表示。

此时，例如在自己的PC上下载文件，普遍来说下载工具以xx MB/s的方式来衡量文件的下载速度。
在这个例子中，这类单位是表示一秒内平均接收xx位的数据。
同样对于上传等，在通过网络进行文件交换的操作中，普遍用这类单位来衡量文件传输的速度。
协议层通过解析数据包，递交数据给上层完成数据交换。（详参OS1模型）

pps

 packet per second的缩写。不同于bps，这个单位不是用于文件传输速度的衡量，而是用于衡量交换机（switch），路由器（router）等网络设备对于帧（frame）或数据包（packet）的处理能力的单位。

1关于帧和数据包的区别，严格意义上而言，简单可理解为：
1由路由器处理的称为数据包
1由交换机处理的称为帧
1然而，在一般讨论中，一般模糊概念统称为数据包（packet）。这也是单位是pps而不是fps的原因。
而为什么要用pps而不用位来衡量的原因是因为以位计量的传输速度（bps类单位）和网络设备接口，网线类型，设备处理能力等多项因素有关，因此在测量/计测网络设备的处理能力时，需要达到一定条件才能以位类单位（bps）测得准确值。
·网络接口（Network Interface）
以思科（Cisco）路由器为例，常见的以太网接口（Ethernet Interface）类型有FastEthernet，GigabitEthernet等。
顾名思义，该接口理论最大传输速度分别为100Mb/s，1Gb/s（详参IEEE802.3标准）
·网线类型（LAN Cable Category）
常见网线类型可分为超五类，六类，超六类，七类网线等等。这些不同类型的网线分别有不同的标准和规格。其中包含有效距离内进行传输可达到的理论最大速度。（详参ISO/IEC 11801）

除此之外，发往网络设备的数据流速度和发送设备的NIC（Network Interface Card，俗称网卡）规格有关。在测试中，如果终端NIC传输标准低级于网络设备接口，网线等的传输标准的情况下，即使排除网线，网络接口等影响因素，假设使用bps类单位可以衡量网络设备的处理能力，结果也会大打折扣。
网络设备仅针对应层数据包进行处理，而不对数据进行解析。（详参Osl模型及下文数据包相关内容）

 

例1

综上，设例有2台带有干兆以太网NIC的PC通过路由器进行文件传输。（不讨论设备的相关设假设文件传输速度可达到最高值，则此例中为1 Gbps，如果以bps类对交换机处理能力进行量，记：此路由器处理能力为1 Gbps.
同样是这台交换机，连接2台带有快速（百兆）以太网NIC的PC进行文件传输，此时传输速率100 Mbps，则记：此路由器处理能力为100 Mbps.
显然，得出的结论是错误的。处理能力作为网络设备本身的属性不会因为所连接的设备而发生化。而能对其产生相对影响的另有他因。
就好像用电脑打游戏，游戏的fps不会因为你的鼠标是USB2.0还是USB3.0还是Bluetooth而改而通常能影响到的一般只有温度，还有其他正在使用显卡（GPU）的进程的使用量。
bps用于表示传输速度
pps用于表示数据包处理速度
那么，到底该如何才能相对准确地衡量网络设备对数据包进行处理的能力大小呢？
这个时候就轮到单位pps登场了。

 

对于一般网络设备，制造商会同时标注设备的传输速度（bps）和数据包处理速度（pps）
这是经过专门测量后标注的设备标准属性。

例如思科交换机Cisco Catalyst3560G-48Ts，其标注为：传输速度：32Gbps数据包处理速度：38.7M pps此时，例如以每秒38.7M个，长为1500B的数据包进行传输时，一秒所需的bps为：
1500Bytes/packet*38.7M packet/s*8 bit/Byte = 453.5G bps可见结果远大于32Gbps，因此使用次交换机进行上述数据包类型传输时会导致严重堵塞。
同样，如果以32Gbps的速度传输长为64B的数据包，一秒所需的pps为：
（32bps）/（64B/packet）/（8bit/B）=64M pps显然，由于结果远大于38.7M pps，此类通信也会导致严重堵塞。